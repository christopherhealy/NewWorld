
<!DOCTYPE html>
<html>
  <head>
    <title>Flippadoo Location Test</title>
    <meta name="viewport" content="width=device-width, height=device-height initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
     <link href="http://dev.tickittaskit.com/flippadoo/styles/style.css" rel="stylesheet" type="text/css">
    <link href="http://dev.tickittaskit.com/flippadoo/styles/jquery.datepick.css" rel="stylesheet" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
    <script src="http://dev.tickittaskit.com/flippadoo/scripts/library/jquery.datepick.js"></script>
    <script src="http://dev.tickittaskit.com/flippadoo/scripts/tickit.js"></script>
    <script type="text/javascript">
        //Location content
        var lc;
        //PhoneGap Ready variable
        var pgr = false;
        var AlertMess = false;

       

        function onBodyLoad() {
            //During testing, Let me know we got this far
            if (AlertMess == true) {
                alert("onBodyLoad");
            }
            //Add the PhoneGap deviceready event listener
            document.addEventListener("deviceready", onDeviceReady, false);
        }

        function onDeviceReady() {
            //During testing, Let me know PhoneGap actually
            // initialized
            if (AlertMess == true) {
                alert("onDeviceReady");
            }
            //Get a handle we'll use to adjust the accelerometer
            //content
            lc = document.getElementById("locationInfo");
            //Set the variable that lets other parts of the program
            //know that PhoneGap is initialized
            pgr = true;
        }

        function getLocation() {
            if (AlertMess == true) {
                if (AlertMess == true) {
                    alert("getLocation");
                }
            }
            if (pgr == true) {
                var locOptions = {
                    timeout: 5000,
                    enableHighAccuracy: true
                };
                //get the current location
                navigator.geolocation.getCurrentPosition(onLocationSuccess, onLocationError, locOptions);
                //Clear the current location while we wait for a reading
                lc.innerHTML = "Reading location...";

            } else {
                if (AlertMess == true) {
                    alert("Please wait,\nPhoneGap is not ready.");
                }
            }
        }

        function onLocationSuccess(loc) {
            if (AlertMess == true) {
                alert("onLocationSuccess");
            }
            //We received something from the API, so first get the
            // timestamp in a date object so we can work with it
            var d = new Date(loc.timestamp);
            //Then replace the page's content with the current
            // location retrieved from the API
            lc.innerHTML = '<b>Current Location</b><hr /><b>Latitude</b>: ' + loc.coords.latitude + '<br /><b>Longitude</b>: ' + loc.coords.longitude + '<br /><b>Altitude</b>: ' + loc.coords.altitude + '<br /><b>Accuracy</b>: ' + loc.coords.accuracy + '<br /><b>Altitude Accuracy</b>: ' + loc.coords.altitudeAccuracy + '<br /><b>Heading</b>: ' + loc.coords.heading + '<br /><b>Speed</b>: ' + loc.coords.speed + '<br /><b>Timestamp</b>: ' + d.toLocaleString();
        }

        function onLocationError(e) {
            alert("Geolocation error: #" + e.code + "\n" + e.message);
        }

        function getDateTime() {
            var now = new Date();
            var year = now.getFullYear();
            var month = now.getMonth() + 1;
            var day = now.getDate();
            var hour = now.getHours();
            var minute = now.getMinutes();
            var second = now.getSeconds();
            if (month.toString().length == 1) {
                var month = '0' + month;
            }
            if (day.toString().length == 1) {
                var day = '0' + day;
            }
            if (hour.toString().length == 1) {
                var hour = '0' + hour;
            }
            if (minute.toString().length == 1) {
                var minute = '0' + minute;
            }
            if (second.toString().length == 1) {
                var second = '0' + second;
            }
            var dateTime = year + '/' + month + '/' + day + ' ' + hour + ':' + minute + ':' + second;
            return dateTime;
        }

        function TestMe() {
            var apiKey = $('#apiKey').val();
            alert("testing insert " + apiKey);
        }
       

        function creatTickitFn() {
            var apiKey = $('#apiKey').val();
            var url = 'http://dev.tickittaskit.com/flippadoo/mobile/tickitService/' + apiKey + '/createTickit';
            $("#createTickit").attr("action", url);

            $("#createTickit").submit();
        }
    </script>
  </head>
  <body onload="onBodyLoad()">
    <h1>Flippaddo Location and time test</h1>
    <p>
      Click the button to determine the current location.
    </p>
    <input type="button" value="Whami" onclick="getLocation();">
    
    <hr />
    <p id="locationInfo">
      We want to insert these into our DB.
    </p>
      <div class="wrapper">
    <div style="width: 200px; height: 100px; margin: 30px auto; padding: 0 20px; background: #f1f1eb; border: 1px solid #0071BC; color: #0071BC; font-size: 15px; -moz-box-shadow:   0 0 10px 0 rgba(0,0,0,0.28); box-shadow:  0 0 10px 0 rgba(0,0,0,0.28); -webkit-border-radius: 10px; -moz-border-radius: 10px; border-radius: 10px;">
        <form name="createTickit" id ="createTickit" action="http://208.75.75.92:8080/flippadoo/mobile/tickitService/createTickit" enctype="multipart/form-data" method="post">
            <div class="header"></div>
            <h2><a href="http://208.75.75.92:8080/flippadoo/app/grid/tickitDetails">Whami from Home v1.0</a> </h2>
            <dl>
                 <dd>
                    <!-- Optional fields -->
                    <!-- input type="hidden" name="tickitCustomId" value="" -->
                    <input type="hidden" name="apiKey" id="apiKey" value="355901361" >                    
                    <input type="hidden" name="ownerId" value="1">
                    <input type="hidden" name="ip" value="http://192.168.1.240:8080">
                    <input type="hidden" name="tickitStatus" value="7">
                    <input type="hidden" name="tickitType" value="12">
                    <!-- in this case the type is child with a specific parent- just an example -->
                    <input type="hidden" name="parentId" value="123456804">
                    <input type="hidden" name="recipient" value="christopherhealy@outlook.com">
                    <input type="hidden" name="subject" value="Whami">
 		    <SCRIPT type="text/javascript">
 		        document.write("<input type='hidden' name='msgBody' value='Local Whami time is: " + getDateTime() + "'>")
                    </SCRIPT>
                    <input type="hidden" name="startDate" value="">
                    <input type="hidden" name="endDate" value="">
                    <!-- substitute this with the actual GPS (this is Chris's home) -->
                    <!-- gps is an array that requires two values, separated by a semi-colon -->
                    <input type="hidden" name="gps" value="45.3875078;-75.7548862">
		    <input type="hidden" name="tickitFile" value="">
                </dd>               
               
            <dl>
            <div class="buttonBlock">
                <button class="submitBTN" onclick="creatTickitFn();">Whami</button>           </div>
	     
        </form>
    </div>
</div>
  </body>
</html>
